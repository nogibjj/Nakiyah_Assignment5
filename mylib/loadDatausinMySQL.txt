import pandas as pd
import mysql.connector
from mysql.connector import errorcode

#Database configuration
config = {"user": "root",
          "password":"password",
          "host":"localhost"}

#data = pd.read_csv("Impact_of_Remote_Work_on_Mental_Health.csv")
#print(data)

def load_data(config):

    try:
        # Connect to MySQL server
        connection = mysql.connector.connect(**config)
        cursor = connection.cursor()

        # Create database if it doesn't exist
        cursor.execute("CREATE DATABASE IF NOT EXISTS my_database")

        # Optionally, use the newly created database
        cursor.execute("USE my_database")

        # Optionally, create a table
        cursor.execute('''
        CREATE TABLE IF NOT EXISTS my_table (
            id INT AUTO_INCREMENT PRIMARY KEY,
            name VARCHAR(100) NOT NULL
        )
        ''')

        # Commit changes and close the connection
        connection.commit()
        cursor.close()
        connection.close()

        print("Database created successfully (or already exists).")

    except mysql.connector.Error as err:
        if err.errno == errorcode.ER_ACCESS_DENIED_ERROR:
            print("Something is wrong with your user name or password")
        elif err.errno == errorcode.ER_BAD_DB_ERROR:
            print("Database does not exist")
        else:
            print(err)

print(load_data(config))